{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "from tools.fit_funcs import least_sq"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# wczytanie pliku ze ścieżki 'data/input01.txt'\n",
    "data = np.loadtxt('data/input01.txt',delimiter=',',skiprows=1).T\n",
    "# dopasowanie do punktów prostej\n",
    "fitAll = least_sq(data[0:2])\n",
    "# niepewność względna których punktów przekracza 5%?\n",
    "dataGreater05 = data.T[np.abs(data[2]/(data[0]*fitAll[0] + fitAll[1])) > 0.05].T\n",
    "dataLess05 = data.T[np.abs(data[2]/(data[0]*fitAll[0] + fitAll[1])) < 0.05].T\n",
    "# dopaswanie tylko dla punktów, których niepewność pomiarowa nie przekracza 5%\n",
    "fitLess05 = least_sq(dataLess05[0:2])\n",
    "fig, ax = plt.subplots()\n",
    "# Wykreśl wczytane dane, wraz z niepewnością pomiarową (rozmiar znacznika punktu 2)\n",
    "ax.errorbar(dataGreater05[0], dataGreater05[1], dataGreater05[2], fmt='r^', markersize=2)\n",
    "ax.errorbar(dataLess05[0], dataLess05[1], dataLess05[2], fmt='ks', markersize=2)\n",
    "fitLineAll = data[0]*fitAll[0] + fitAll[1]\n",
    "fitLineLess05 = dataLess05[0]*fitLess05[0] + fitLess05[1]\n",
    "# Wykreśl dopasowane proste przerywaną linią\n",
    "ax.plot(data[0], fitLineAll, '--b', label='all')\n",
    "ax.plot(dataLess05[0], fitLineLess05, '--g', label=r'$\\Delta<5$%')\n",
    "ax.legend()\n",
    "# wyświetla skończony wykres\n",
    "fig\n",
    "# zapisanie go do pliku\n",
    "fig.savefig('fitted_input01.png', dpi=200)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
